# Accretion Physics Configuration
#
# All values here override the compiled defaults in src/constants.rs.
# Missing keys fall back to the compiled defaults — you only need to list
# the values you want to change.
#
# The game hot-reloads this file at runtime (polled); no restart/recompile needed.
# Validate changes by running: ./test_all.sh
#
# ── World Bounds ──────────────────────────────────────────────────────────────

# Width / height of the initial asteroid spawn region (world units).
# Asteroids are placed within ±sim_width/2 of the origin.
sim_width = 4000.0
sim_height = 4000.0

# Gap between the spawn grid edge and the outer simulation boundary.
spawn_grid_margin = 150.0

# Radius around the player start position (origin) kept clear of asteroids.
# Increase for more breathing room; decrease for faster early encounters.
player_buffer_radius = 100.0

# ── Physics: Gravity ──────────────────────────────────────────────────────────

# Inverse-square gravity strength.
# Higher → stronger attraction → faster cluster formation.
# Tested range: 5.0–15.0.  Above ~20.0 causes runaway acceleration at close range.
gravity_const = 10.0

# Asteroids closer than this (world units) are excluded from gravity calculations.
# Rapier handles contact physics below this threshold to prevent energy injection.
# Tested range: 3.0–10.0.
min_gravity_dist = 5.0

# Maximum distance at which gravity is applied.
max_gravity_dist = 1000.0

# ── Physics: Cluster Formation ────────────────────────────────────────────────

# Maximum linear speed (u/s) for velocity synchronisation of touching asteroids.
# Lower → only nearly-stationary asteroids are synced; higher → more aggressive.
# Note: merging is now governed by gravitational binding energy, not velocity threshold.
velocity_threshold_locking = 5.0

# Sanity-check limits for merged hull extents.
# allowed_extent = hull_extent_base + cluster_members × hull_extent_per_member
# Merges producing larger hulls are rejected as corrupted.
hull_extent_base = 60.0
hull_extent_per_member = 20.0

# ── Physics: Collision ────────────────────────────────────────────────────────

# Restitution for small (unit) asteroids.  0.0 = perfectly inelastic.
restitution_small = 0.0

# Friction coefficient for asteroid–asteroid contacts.
friction_asteroid = 1.0

# ── Physics: Culling ──────────────────────────────────────────────────────────

# Distance from origin beyond which asteroids are permanently removed.
# Should match max_gravity_dist to avoid phantom forces from culled asteroids.
cull_distance = 2000.0

# ── Physics: Neighbor Counting ────────────────────────────────────────────────

# Radius used to decide whether two asteroids are "close neighbours".
neighbor_threshold = 3.0

# ── Spatial Grid ──────────────────────────────────────────────────────────────

# World-space size of each spatial grid cell.
# Must be >= largest query radius / 2 to keep cell-check count manageable.
grid_cell_size = 500.0

# ── Camera ────────────────────────────────────────────────────────────────────

# Zoom scale limits (camera.scale = zoom → larger = zoomed out).
min_zoom = 0.5
max_zoom = 4.0

# Zoom scale change per scroll-wheel event.
zoom_speed = 0.1

# ── Player: Movement ──────────────────────────────────────────────────────────

# Forward thrust force (N) while W is held.
thrust_force = 25000.0

# Reverse thrust force (N) while S is held.
reverse_force = 12500.0

# Angular velocity (rad/s) while A / D are held.
rotation_speed = 3.0

# Rapier linear / angular damping on the player ship.
player_linear_damping = 0.1
player_angular_damping = 10.0

# Radius (world units) of the player ship's ball collider.
player_collider_radius = 8.0

# Restitution coefficient for the player ship.
player_restitution = 0.3

# ── Player: Out-of-Bounds ─────────────────────────────────────────────────────

# Distance from origin where the soft boundary begins.
oob_radius = 2000.0

# Minimum velocity decay factor per frame at max out-of-bounds depth.
# Closer to 1.0 = gentler drag; closer to 0.0 = harsher.
oob_damping = 0.97

# Width of the damping ramp zone.  Damping increases linearly from 0% at
# oob_radius to (1.0 - oob_damping)*100% at oob_radius + oob_ramp_width.
oob_ramp_width = 200.0

# ── Player: Tractor Beam ─────────────────────────────────────────────────────

# Base beam interaction radius (world units).
tractor_beam_range_base = 280.0

# Additional interaction radius per tractor level.
tractor_beam_range_per_level = 35.0

# Base tractor beam force magnitude.
tractor_beam_force_base = 8000.0

# Additional force per tractor level.
tractor_beam_force_per_level = 1200.0

# Max asteroid size affected at tractor level 0.
tractor_beam_max_target_size_base = 4

# Additional max affected size per tractor level.
tractor_beam_max_target_size_per_level = 2

# Max asteroid speed (u/s) affected at tractor level 0.
tractor_beam_max_target_speed_base = 140.0

# Additional max affected speed per tractor level.
tractor_beam_max_target_speed_per_level = 20.0

# Minimum distance where beam starts applying force.
tractor_beam_min_distance = 20.0

# Aim cone dot threshold for a 30° total cone (±15° around aim direction).
tractor_beam_aim_cone_dot = 0.9659

# Freeze-mode (`Q+E`) relative-velocity damping strength.
tractor_beam_freeze_velocity_damping = 260.0

# Relative speed (u/s) where freeze damping reaches its full-strength knee.
# Above this speed, damping scales down to avoid force spikes.
tractor_beam_freeze_max_relative_speed = 160.0

# Maximum freeze force as a multiplier of level-scaled base tractor force.
tractor_beam_freeze_force_multiplier = 1.35

# Spring stiffness for freeze hold position correction (higher = tighter hold).
tractor_beam_freeze_offset_stiffness = 90.0

# Maximum stored hold offset radius from ship while freezing.
tractor_beam_freeze_max_hold_offset = 180.0

# Additional frozen-mode safety multipliers applied to level-scaled target limits.
tractor_beam_freeze_max_target_size_multiplier = 0.75
tractor_beam_freeze_max_target_speed_multiplier = 0.8

# ── Enemy Ships: Foundation ─────────────────────────────────────────────────

# Spawn pacing and deterministic progression.
enemy_spawn_base_cooldown = 16.0
enemy_spawn_cooldown_per_stage = 1.2
enemy_spawn_cooldown_min = 4.0

# Simultaneous enemy limits.
enemy_max_count_base = 1
enemy_max_count_per_stage = 1
enemy_max_count_cap = 6

# Session progression stage inputs.
enemy_stage_time_secs = 45.0
enemy_stage_score_points = 350

# Deterministic spawn geometry constraints.
enemy_spawn_radius = 640.0
enemy_min_player_spawn_distance = 300.0
enemy_min_enemy_spacing = 180.0

# Basic seek-movement tuning.
enemy_seek_force = 4800.0
enemy_max_speed = 165.0
enemy_arrive_radius = 120.0

# Enemy body defaults.
enemy_collider_radius = 10.0
enemy_linear_damping = 1.8
enemy_angular_damping = 8.0
enemy_base_hp = 60.0

# Enemy combat loop tuning.
enemy_fire_cooldown_base = 2.1
enemy_projectile_speed = 360.0
enemy_projectile_lifetime = 3.4
# Maximum travel distance from spawn (world units) before enemy-projectile despawn.
enemy_projectile_max_dist = 2200.0
enemy_projectile_collider_radius = 3.0
enemy_projectile_damage = 12.0
enemy_damage_from_player_projectile = 25.0
enemy_damage_from_player_missile = 60.0
enemy_asteroid_collision_damage_threshold = 32.0
enemy_asteroid_collision_damage_scale = 0.42
enemy_kill_score = 35

# ── Player: Combat ────────────────────────────────────────────────────────────

# Projectile muzzle speed (u/s).
projectile_speed = 500.0

# Minimum seconds between consecutive shots.
fire_cooldown = 0.2

# Seconds before a live projectile is automatically despawned.
projectile_lifetime = 3.0

# Maximum travel distance from spawn (world units) before projectile despawn.
projectile_max_dist = 2000.0

# Radius (u) of each projectile's ball collider.
projectile_collider_radius = 2.0

# ── Player: Missiles ─────────────────────────────────────────────────────────

# Maximum missile ammo capacity.
missile_ammo_max = 5

# Initial speed (u/s) when missiles spawn.
missile_initial_speed = 170.0

# Maximum missile speed (u/s) reached after acceleration.
missile_speed = 430.0

# Missile linear acceleration (u/s²) until `missile_speed` is reached.
missile_acceleration = 900.0

# Minimum seconds between consecutive missile shots.
missile_cooldown = 0.4

# Seconds before a missile despawns automatically.
missile_lifetime = 4.0

# Maximum travel distance from spawn (world units) before missile despawn.
missile_max_dist = 2000.0

# Radius (u) of missile collider.
missile_collider_radius = 5.0

# Legacy recharge constant (not used by current ore-based ammo economy).
missile_recharge_secs = 12.0

# Maximum number of split fragments missiles can produce on a single impact.
# Actual piece count scales by missile level and is clamped by this value.
missile_split_max_pieces = 12

# ── Player: Health ────────────────────────────────────────────────────────────

# Player ship starting and maximum HP.
player_max_hp = 100.0

# Relative speed (u/s) below which asteroid impacts deal zero damage.
damage_speed_threshold = 30.0

# Seconds of invincibility after taking damage (prevents rapid stacking).
invincibility_duration = 0.5

# ── Ore Magnet ────────────────────────────────────────────────────────────────

# Distance (u) from the player within which ore pickups are attracted to the ship.
ore_magnet_radius = 250.0

# Speed (u/s) at which attracted ore lerps toward the player.
ore_magnet_strength = 120.0
# HP restored when the player spends one ore on healing (H key).
ore_heal_amount = 30.0
# ── Gamepad ───────────────────────────────────────────────────────────────────

# Left-stick dead zone fraction (inputs below this are ignored).
gamepad_left_deadzone = 0.15

# Velocity decay factor per frame while the brake button (B / East) is held.
gamepad_brake_damping = 0.82

# Seconds of aim inactivity before auto-snapping back to ship forward.
aim_idle_snap_secs = 1.0

# Right-stick dead zone fraction.
gamepad_right_deadzone = 0.2

# Right-stick deflection fraction required to trigger auto-fire.
gamepad_fire_threshold = 0.5

# Minimum angular error (rad) before the ship actively corrects heading.
gamepad_heading_snap_threshold = 0.05

# ── Rendering ─────────────────────────────────────────────────────────────────

# Live asteroid count above which force-vector gizmos are skipped.
force_vector_hide_threshold = 200

# Scale factor for force-vector gizmo lines.
force_vector_display_scale = 80.0

# Minimum force magnitude to draw a force-vector gizmo.
force_vector_min_length = 0.1

# Font size for the on-screen statistics overlay.
stats_font_size = 20.0

# ── Asteroid Geometry ─────────────────────────────────────────────────────────

# Minimum distance (u) between hull vertices before they're considered duplicates.
hull_dedup_min_dist = 0.5

# Base side length for spawned equilateral triangles (at scale 1.0).
triangle_base_side = 4.0

# Half-extent for spawned squares (at scale 1.0).
square_base_half = 5.0

# Circumradius for spawned pentagons and hexagons (at scale 1.0).
polygon_base_radius = 6.0

# Circumradius for spawned heptagons (7-sided) at scale 1.0.
heptagon_base_radius = 7.0

# Circumradius for spawned octagons (8-sided) at scale 1.0.
octagon_base_radius = 8.0

# Circumradius for the large planetoid asteroid (16-sided near-circle) at scale 1.0.
planetoid_base_radius = 25.0

# Unit-size assigned to a spawned planetoid (reflects dominant mass).
planetoid_unit_size = 16

# Asteroid size scale range (multiplier applied to base geometry).
asteroid_size_scale_min = 0.8
asteroid_size_scale_max = 1.6

# Random initial velocity component range per axis (u/s).
asteroid_initial_velocity_range = 15.0

# Asteroid density: mass units per world-unit² connecting visual size to mass.
# target_area = asteroid_size / asteroid_density
# Calibrated so an AsteroidSize=1 body has roughly the same area as a small triangle.
# Lower → bigger asteroids; higher → smaller asteroids for the same mass.
asteroid_density = 0.1

# Random initial angular velocity range (rad/s).
asteroid_initial_angvel_range = 5.0
